<!-- After supabase UMD + common.js -->
<script src="common.js"></script>
<script>
  (function(){
    const btn = document.getElementById('btn-login') || document.querySelector('[data-login]');
    if (!btn) return console.warn('Login button not found, skip wiring');

    btn.addEventListener('click', async (e) => {
      e.preventDefault();
      const email = (document.getElementById('li-email')||{}).value || (document.querySelector('[name="email"]')||{}).value;
      const password = (document.getElementById('li-password')||{}).value || (document.querySelector('[name="password"]')||{}).value;
      if (!email || !password) return alert('Enter email & password');

      btn.disabled = true;
      btn.innerText = 'Logging in...';

      const { data, error } = await Common.signIn(email, password);
      if (error) {
        btn.disabled = false;
        btn.innerText = 'Log in';
        return alert('Login error: ' + error.message);
      }

      // On success redirect to home
      window.location.href = 'home.html';
    });
  })();
</script>
