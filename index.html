<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Resume Builder — Sign up</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    /* Teal gradient center card style (matches forgot page feel) */
    :root {
      --bg1:#0f3a37;
      --bg2:#18c1b3;
      --card:#118779;
      --muted:#cfe8e5;
    }
    html,body{height:100%;margin:0;font-family:Inter, system-ui, Arial, sans-serif;color:#fff}
    body{
      background: linear-gradient(90deg,var(--bg1), var(--bg2));
      display:flex;align-items:center;justify-content:center;padding:48px;
    }
    .card{
      width:760px; max-width:95%; background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      border-radius:12px; box-shadow: 0 30px 60px rgba(0,0,0,0.35);
      padding:40px; text-align:center;
    }
    h1{font-size:34px;margin:0 0 8px 0;letter-spacing:0.5px}
    p.lead{margin:0 0 28px;color:rgba(255,255,255,0.9)}
    label{display:block;text-align:left;font-size:12px;margin:8px 0 6px 0;opacity:0.9}
    input{width:100%;padding:16px;border-radius:999px;border:0;background:#fff;color:#17514e;font-weight:600;box-shadow:inset 0 2px 0 rgba(0,0,0,0.03);font-size:14px}
    .row{display:flex;gap:12px}
    .row .col{flex:1}
    .actions{display:flex;gap:12px;justify-content:center;margin-top:20px}
    .btn{padding:12px 28px;border-radius:30px;border:0;background:linear-gradient(180deg,#0fb1a7,#06d1c0);color:#012;font-weight:700;cursor:pointer;letter-spacing:1px}
    .btn.alt{background:transparent;border:2px solid rgba(255,255,255,0.12);color:#fff}
    .help{margin-top:16px;color:rgba(255,255,255,0.8)}
    a.link{color:#fff;text-decoration:underline}
    .small{font-size:13px;opacity:0.85}
  </style>
</head>
<body>
  <div class="card" role="main">
    <h1>Resume Builder</h1>
    <p class="lead">Create an account — save profiles and generate tailored resumes</p>

    <label for="su-name">Full name</label>
    <input id="su-name" placeholder="Your full name" />

    <label for="su-email">Email</label>
    <input id="su-email" placeholder="you@domain.com" />

    <label for="su-password">Password (min 6 chars)</label>
    <input id="su-password" type="password" placeholder="Choose a password" />

    <div class="actions">
      <button class="btn" id="btn-signup">Sign up</button>
      <button class="btn alt" id="btn-to-login">Login</button>
    </div>

    <p class="help small">By signing up you agree to our <strong>Terms</strong>. Already have an account? <a class="link" href="login.html">Log in</a></p>
  </div>

  <!-- supabase UMD -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/umd/supabase.min.js"></script>
  <script src="common.js"></script>
  <script>
    // Signup flow: simple create user then redirect to home
    document.getElementById('btn-signup').onclick = async () => {
      const name = document.getElementById('su-name').value.trim();
      const email = document.getElementById('su-email').value.trim();
      const password = document.getElementById('su-password').value;
      if (!email || !password) return alert('Email and password required');
      const { data, error } = await App.client.auth.signUp({ email, password });
      if (error) return alert('Signup error: ' + error.message);
      // optional: create a profiles row with basic name (user id not yet available until confirm in some setups)
      alert('Signup successful. You may need to confirm via email. Logging you in...');
      // try to sign in immediately
      const { data: loginData, error: loginErr } = await App.client.auth.signInWithPassword({ email, password });
      if (loginErr) {
        // still go to login page
        window.location.href = 'login.html';
      } else {
        // upsert basic profile
        const user = (await App.getUser());
        if (user) {
          await App.upsertProfile({ id: user.id, full_name: name || null });
        }
        App.gotoHome();
      }
    };

    document.getElementById('btn-to-login').onclick = () => { window.location.href = 'login.html' }
  </script>
</body>
</html>
