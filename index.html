<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Resume Builder — Signup / Login</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: Arial, Helvetica, sans-serif; max-width:760px; margin:2rem auto; padding:1rem; color:#f1f1f1; background:#0f1720; }
    .card { background:#0b1220; border:1px solid #172033; padding:16px; border-radius:8px; margin-bottom:12px; }
    input, button {
      display:block; width:100%; margin:8px 0; padding:10px; 
      border-radius:6px; border:1px solid #233040; background:#071226; color:#fff;
      box-sizing:border-box;
    }
    button { cursor:pointer; background:#0ea5a4; color:#012; border:0; font-weight:600; }
    small { color:#9aa7b2; }
  </style>

  <!-- Supabase + common.js -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/umd/supabase.min.js"></script>
  <script src="common.js"></script>
</head>

<body>
  <h1>Resume Builder — Signup / Login</h1>

  <div class="card">
    <h3>Sign up</h3>
    <input id="su-email" placeholder="Email" />
    <input id="su-password" type="password" placeholder="Password (min 6 chars)" />
    <button id="btn-signup">Sign up</button>

    <h3>Log in</h3>
    <input id="li-email" placeholder="Email" />
    <input id="li-password" type="password" placeholder="Password" />
    <button id="btn-login">Log in</button>

    <p id="auth-msg"><small>Use signup first, then login.</small></p>
  </div>


<script>
// redirect user if already logged in
redirectIfLoggedIn();

const authMsg = document.getElementById("auth-msg");

// SIGNUP
document.getElementById("btn-signup").onclick = async () => {
  authMsg.textContent = "Signing up...";
  const email = document.getElementById("su-email").value;
  const password = document.getElementById("su-password").value;

  const { error } = await supabaseClient.auth.signUp({ email, password });

  if (error) authMsg.textContent = "Error: " + error.message;
  else authMsg.textContent = "Signup successful. Now login.";
};

// LOGIN → redirect to home.html
document.getElementById("btn-login").onclick = async () => {
  authMsg.textContent = "Logging in...";
  const email = document.getElementById("li-email").value;
  const password = document.getElementById("li-password").value;

  const { error } = await supabaseClient.auth.signInWithPassword({ email, password });

  if (error) authMsg.textContent = "Error: " + error.message;
  else window.location.href = "home.html";
};
</script>

</body>
</html>
